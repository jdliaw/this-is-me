<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1" /> <title>An Issues Archive</title> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:title" content="An Issues Archive" /> <meta name="twitter:description" content="A Personal Record"> <meta name="description" content="A Personal Record"> <link rel="icon" href="https://avatars3.githubusercontent.com/u/10488856?v=3&s=80"> <link rel="apple-touch-icon" href="/assets/touch-icon.png"> <link rel="stylesheet" href="//code.cdn.mozilla.net/fonts/fira.css"> <link rel="stylesheet" href="/assets/core.css"> <link rel="canonical" href="/tech/2016/07/16/an-issues-archive.html"> <link rel="alternate" type="application/atom+xml" title="this is me." href="/feed.xml" /> </head> <body> <aside class="logo"> <a href="/"> <img src="https://avatars3.githubusercontent.com/u/10488856?v=3&s=80" class="gravatar"> </a> <span class="logo-prompt">Back to Home</span> </aside> <aside class="navigation"> <a href="/tech.html">tech</a> / <a href="/food.html">food</a> / <a href="/travel.html">travel</a> / <a href="/thoughts.html">thoughts</a> / <a href="/categories.html">more</a> </aside> <main> <noscript> <style> article .footnotes { display: block; } </style> </noscript> <article> <div class="center"> <h1>An Issues Archive</h1> <time>July 16, 2016</time> </div> <div class="divider"></div> <h2 id="a-personal-record">A Personal Record</h2> <p>To remember what I’ve accomplished and learned this summer &amp; help me recount or reuse what I did.</p> <div class="divider"></div> <p><em>In chronological order</em></p> <p><strong><em>Note:</em></strong> Bigger tickets will be put in their own post!!</p> <div class="divider"></div> <h1 id="adjust-popup-time-on-email-capture-modal">1. Adjust popup time on Email Capture Modal</h1> <ul> <li> <p>Literally going into the <strong>coffeescript</strong> file for the email capture modal and changing the timeout from 5000ms to 12000ms.</p> </li> <li> <p>Learned about the git workflow (PRs &amp; merging into beta &amp; whatnot) and navigating the codebase (ish) though!</p> </li> </ul> <h1 id="update-publisher-lead-gen-destinations">2. Update publisher lead gen destinations</h1> <ul> <li> <p>Learned about <strong>Sidekiq</strong>: enqueues jobs such as sending out emails.</p> </li> <li> <p>In development, all emails are caught in <strong>MailTrap</strong>, which you can log into via <strong>Bitium</strong>.</p> </li> <li> <p><strong>Redis</strong> server needs to be running for jobs to enqueue. Broke my first &amp; learned about <strong>specs</strong> – you always need to update or add specs for changes that are more than just simple UI things.</p> </li> </ul> <h1 id="on-ios-bbb-and-powered-by-stackcommerce-footer-logos-blocked-by-add-to-cart-button">3. on iOS BBB and Powered by StackCommerce footer logos blocked by Add To Cart button</h1> <ul> <li>Simple changing margins in CSS on mobile settings using Javascript</li> </ul> <h1 id="add-button-to-resend-order-confirmation-email">4. Add button to resend order confirmation email</h1> <ul> <li> <p>Wow! I got to create a cool button on the Admin page using Bootstrap styles!!! Fun stuff</p> </li> <li> <p>Learning <strong>erb</strong> and how to use buttons to execute a method:</p> </li> </ul> <div class="highlighter-rouge"><pre class="highlight"><code><span class="o">&lt;</span><span class="sx">%= link_to "Resend Confirmation Email", resend_confirmation_email_admin_order_path(@order), class: "button", method: :post %&gt;
</span></code></pre></div> <ul> <li>Setting up routes and the method in the appropriate controller to execute the task:</li> </ul> <div class="highlighter-rouge"><pre class="highlight"><code><span class="n">config</span><span class="o">/</span><span class="n">routes</span><span class="p">.</span><span class="nf">rb</span>

<span class="n">member</span> <span class="k">do</span>
  <span class="n">post</span> <span class="ss">:resend_confirmation_email</span>
<span class="k">end</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="o">/</span><span class="n">controllers</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">orders_controller</span><span class="p">.</span><span class="nf">rb</span>

<span class="k">def</span> <span class="nf">resend_confirmation_email</span>
  <span class="vi">@order</span><span class="p">.</span><span class="nf">send_confirmation_email</span>
  <span class="n">redirect_to</span> <span class="n">admin_user_order_path</span><span class="p">(</span><span class="vi">@order</span><span class="p">.</span><span class="nf">user</span><span class="p">,</span> <span class="vi">@order</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div> <ul> <li>Creating specs to test a new feature!!!</li> <li>Extra special because I had to figure out some Sidekiq stuff</li> </ul> <div class="highlighter-rouge"><pre class="highlight"><code><span class="n">spec</span><span class="o">/</span><span class="n">controllers</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">orders_controller_spec</span><span class="p">.</span><span class="nf">rb</span>

<span class="n">describe</span> <span class="s1">'resend_confirmation_email'</span> <span class="k">do</span>
  <span class="no">Sidekiq</span><span class="o">::</span><span class="no">Testing</span><span class="p">.</span><span class="nf">fake!</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">'enqueues job onto Sidekiq mailer'</span> <span class="k">do</span>
      <span class="n">admin</span> <span class="o">=</span> <span class="n">create</span> <span class="ss">:user</span><span class="p">,</span> <span class="ss">:admin</span>
      <span class="n">sign_in_as</span> <span class="n">admin</span>

      <span class="n">order</span> <span class="o">=</span> <span class="n">create</span> <span class="ss">:order</span><span class="p">,</span> <span class="ss">:w_item</span>

      <span class="n">expect</span><span class="p">{</span><span class="n">post</span> <span class="ss">:resend_confirmation_email</span><span class="p">,</span> <span class="ss">id: </span><span class="n">order</span><span class="p">.</span><span class="nf">id</span><span class="p">}.</span><span class="nf">to</span> <span class="p">(</span>
      <span class="n">change</span><span class="p">(</span><span class="no">Sidekiq</span><span class="o">::</span><span class="no">Extensions</span><span class="o">::</span><span class="no">DelayedMailer</span><span class="p">.</span><span class="nf">jobs</span><span class="p">,</span> <span class="ss">:size</span><span class="p">).</span><span class="nf">by</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">it</span> <span class="s1">'redirects to /users/:user_id/orders/:id'</span> <span class="k">do</span>
    <span class="n">admin</span> <span class="o">=</span> <span class="n">create</span> <span class="ss">:user</span><span class="p">,</span> <span class="ss">:admin</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">create</span> <span class="ss">:order</span>

    <span class="n">sign_in_as</span> <span class="n">admin</span>

    <span class="n">get</span> <span class="ss">:show</span><span class="p">,</span> <span class="ss">id: </span><span class="n">order</span><span class="p">.</span><span class="nf">id</span>

    <span class="n">expect</span><span class="p">(</span><span class="n">response</span><span class="p">).</span><span class="nf">to</span> <span class="n">redirect_to</span><span class="p">(</span><span class="n">admin_user_order_path</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="nf">user</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div> <ul> <li>My first like, kind of grown-up spec where I made a real feature and tested it and everything. Learned a lot and even marked it as my PR I was proud of just because of the struggles it took.</li> </ul> <h1 id="remove-product-icon-in-bundles">5. Remove product icon in bundles</h1> <ul> <li>Literally just removed like a div</li> </ul> <h1 id="js-example-for-sales-api">6. JS example for Sales API</h1> <ul> <li> <p>Barragan basically did this for me during one of our pairing sessions lol</p> </li> <li> <p>Used <a href="https://jsfiddle.net/kv67ks0c/">jsfiddle</a> &amp; Bootstrap to consume our API endpoint and display sales nicely:</p> </li> </ul> <div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">publisher_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">per_page</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">'//api.stacksocial.com/v0/search/sales?publisher_id='</span> <span class="o">+</span> <span class="nx">publisher_id</span> <span class="o">+</span> <span class="s1">'&amp;per_page='</span> <span class="o">+</span> <span class="nx">per_page</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#sales-template"</span><span class="p">).</span><span class="nx">html</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">$</span><span class="p">(</span><span class="s1">'body'</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">template</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
<span class="p">});</span>
</code></pre></div> <ul> <li> <p>I honestly didn’t know how to get the json stuff so that was cool (we just copied an example)</p> </li> <li> <p>We used <a href="http://v4-alpha.getbootstrap.com/components/card/#content-types">Bootstrap cards</a> to make them nice little sales displays</p> </li> <li> <p>Also used Handlebars to increase readability / make it look more like a template:</p> </li> </ul> <p><strong>Handlebars</strong>: a templating language used with html. These two lines compile the template in javascript:</p> <div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#sales-template"</span><span class="p">).</span><span class="nx">html</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>
</code></pre></div> <p>The template is then delivered to the browser in the <code class="highlighter-rouge">&lt;script&gt;</code> tag. In this example, our templated variables help us extract the data from the JSON object received from the API call.</p> <p>JSON received from API call: <img src="/assets/images/issues-archive/sales-api.png" alt="ApiCall" /></p> <p>How we used Handlebars to extract the <code class="highlighter-rouge">title</code>, <code class="highlighter-rouge">subtitle</code>, and <code class="highlighter-rouge">main_image</code> from each sales in the JSON and put them into pretty cards:</p> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;script id="sales-template" type="text/x-handlebars-template"&gt;
  &lt;div class="container-fluid"&gt;
    &lt;div class="row"&gt;
    	 {{#each sales}}
      	&lt;div class="col-xs-4"&gt;
         &lt;div class="card"&gt;
           &lt;img class="card-img-top" src="{{main_image}}"&gt;
          &lt;div class="card-block"&gt;
            &lt;h6 class="card-title"&gt;{{title}}&lt;/h4&gt;
            &lt;p class="card-text"&gt;{{subtitle}}&lt;/p&gt;
          &lt;/div&gt;
         &lt;/div&gt;
       &lt;/div&gt;
      {{/each}} 
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/script&gt;
</code></pre></div> <p>The final result:</p> <p><img src="/assets/images/issues-archive/sales-api-example.png" alt="Result" /></p> <div class="divider"></div> <h1 id="reset-password-email-not-branded">7. Reset password email not branded</h1> <ul> <li>Mostly looking and copying. Adjusting the ClearanceMailer to use the same BaseMailer that the TransactionalMailer was using to get the header, footer, and nice formatting in the order confirmation etc. emails</li> </ul> <div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ClearanceMailer</span> <span class="o">&lt;</span> <span class="no">BaseMailer</span>
  <span class="k">def</span> <span class="nf">change_password</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">publisher_id</span><span class="p">)</span>
    <span class="vi">@current_publisher</span> <span class="o">=</span> <span class="no">Publisher</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">publisher_id</span><span class="p">)</span>
    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

    <span class="n">mail</span> <span class="ss">to: </span><span class="vi">@user</span><span class="p">.</span><span class="nf">email</span><span class="p">,</span>
    	 <span class="ss">from: </span><span class="s2">"</span><span class="si">#{</span><span class="vi">@current_publisher</span><span class="p">.</span><span class="nf">platform_name</span><span class="si">}</span><span class="s2"> &lt;</span><span class="si">#{</span><span class="vi">@current_publisher</span><span class="p">.</span><span class="nf">support_email</span><span class="si">}</span><span class="s2">&gt;"</span><span class="p">,</span>
    	 <span class="ss">subject: </span><span class="s1">'Change your password'</span><span class="p">,</span>
    	 <span class="s2">"X-From-Name"</span> <span class="o">=&gt;</span> <span class="vi">@current_publisher</span><span class="p">.</span><span class="nf">platform_name</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div> <ul> <li>Then once again kind of “cherry-picking”, if you will (I’m probably totally using it wrong), the erb view from the order confirmation emails to have the content &amp; button needed for reset password.</li> </ul> <h1 id="convert-all-state-machines-to-statesman">8. Convert all state machines to statesman</h1> <ul> <li>My first big, meaty ticket!!! See <a href="/2016/07/14/statesman.html">here</a> for full post.</li> </ul> <h1 id="add-academies-section-to-stackcommerce">9. Add Academies section to stackcommerce</h1> <ul> <li> <p>Ez front-end stuff, ya feel</p> </li> <li> <p>Adding new assets to use</p> </li> <li> <p>Once again kind of looking at existing divs and copying &amp; modifying until it looked like the mock</p> </li> <li> <p>ADD PIC</p> </li> </ul> <h1 id="stackcommerce-vendor-signup-does-not-acknowledge-sign-up">10. StackCommerce vendor signup does not acknowledge sign up</h1> <ul> <li> <p>Literally the confirmation modal already existed (for instructor sign up), so I just had to add the div to the vendor signup view and the JS and everything was already there to get it working</p> </li> <li> <p>ADD PIC</p> </li> </ul> <h1 id="add-custom-fields-to-fb-feed-product-catalog">11. Add custom fields to FB feed product catalog</h1> <ul> <li> <p>This was really simple bc Nick showed me the file for the rss builder, I just added a new xml tag with the label and data that they wanted.</p> </li> <li> <p>Did write a new method in the decorator to calculate appropriate amounts, reusing / looking at old methods. (These methods can only be called if you decorate the sale first!)</p> </li> <li> <p>Remember to always update corresponding specs!</p> </li> </ul> <div class="highlighter-rouge"><pre class="highlight"><code><span class="vi">@sales</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">sale</span><span class="o">|</span>
  <span class="n">xml</span><span class="p">.</span><span class="nf">item</span> <span class="k">do</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:id'</span><span class="p">,</span> <span class="n">sale</span><span class="p">.</span><span class="nf">id</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:availability'</span><span class="p">,</span> <span class="n">facebook_sale_availability</span><span class="p">(</span><span class="n">sale</span><span class="p">)</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:condition'</span><span class="p">,</span> <span class="s1">'new'</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:description'</span><span class="p">,</span> <span class="n">sale</span><span class="p">.</span><span class="nf">title</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:product_type'</span><span class="p">,</span> <span class="n">facebook_product_type</span><span class="p">(</span><span class="n">sale</span><span class="p">)</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:image_link'</span><span class="p">,</span> <span class="n">sale</span><span class="p">.</span><span class="nf">main_image</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:link'</span><span class="p">,</span> <span class="n">sale_url</span><span class="p">(</span><span class="n">sale</span><span class="p">)</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:title'</span><span class="p">,</span> <span class="n">sale</span><span class="p">.</span><span class="nf">name</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:price'</span><span class="p">,</span> <span class="s2">"</span><span class="si">#{</span><span class="n">sale</span><span class="p">.</span><span class="nf">price</span><span class="si">}</span><span class="s2"> USD"</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:brand'</span><span class="p">,</span> <span class="n">current_publisher</span><span class="p">.</span><span class="nf">name</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:expiration_date'</span><span class="p">,</span> <span class="n">sale</span><span class="p">.</span><span class="nf">expires_at</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:custom_label_0'</span><span class="p">,</span> <span class="n">sale</span><span class="p">.</span><span class="nf">promotion_percentage</span>
    <span class="n">xml</span><span class="p">.</span><span class="nf">tag!</span> <span class="s1">'g:custom_label_1'</span><span class="p">,</span> <span class="n">sale</span><span class="p">.</span><span class="nf">discount_in_dollars</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div> <p>Those last two custom labels are mine!</p> <h1 id="collect-source-info-for-users-and-orders">12. Collect source info for users and orders</h1> <ul> <li> <p>Another kind of big, interesting ticket, which I had no idea how to approach but turned out to be pretty simple.</p> </li> <li> <p>See <a href="/2016/07/14/utm-tracking.html">here</a> for full post</p> </li> </ul> <h1 id="update-seo-meta-description">13. Update SEO meta description</h1> <ul> <li> <p>Literally Talysson had already made a PR for it, so I just mimicked his changes and added the different titles / descriptions for the different verticals. And Hsieh corrected my syntax / style. Ez.</p> </li> <li> <p><strong>Meta title / description</strong>: the title shows up on your browser window, and the title &amp; description show when your site is listed on Google searches. Can be found by viewing page source.</p> </li> <li> <p>Basically we needed different titles &amp; descriptions for each vertical (since they have 3 now) so here’s the syntax I used:</p> </li> </ul> <div class="highlighter-rouge"><pre class="highlight"><code><span class="vi">@title</span> <span class="o">=</span> <span class="k">if</span> <span class="n">current_publisher</span><span class="p">.</span><span class="nf">vertical</span> <span class="o">==</span> <span class="s1">'lifestyle'</span>
  <span class="s2">"</span><span class="si">#{</span><span class="n">current_publisher</span><span class="p">.</span><span class="nf">platform_name</span><span class="si">}</span><span class="s2">: Modern &amp; Stylish Goods for Men"</span>
<span class="k">elsif</span> <span class="n">current_publisher</span><span class="p">.</span><span class="nf">vertical</span> <span class="o">==</span> <span class="s1">'academy'</span>
  <span class="s2">"</span><span class="si">#{</span><span class="n">current_publisher</span><span class="p">.</span><span class="nf">platform_name</span><span class="si">}</span><span class="s2">: Online Courses from Top Instructors"</span>
<span class="k">else</span>
  <span class="s2">"</span><span class="si">#{</span><span class="n">current_publisher</span><span class="p">.</span><span class="nf">platform_name</span><span class="si">}</span><span class="s2">: The Hottest Tech Deals, Delivered Daily"</span>
<span class="k">end</span>
</code></pre></div> <h1 id="product-fields-directly-injects-html-into-page">14. Product fields directly injects HTML into page</h1> <ul> <li>WIP, big meaty one again yay!!! The ticket title is not very informative.</li> </ul> </article> <div class="back"> <a href="/">Back</a> </div> </main> </body> </html>